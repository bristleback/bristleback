<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>bristle-auth.js - Bristleback Client API</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.7.0&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.7.0&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http:&#x2F;&#x2F;bristleback.pl&#x2F;img&#x2F;bristleback-logo-green.png" title="Bristleback Client API"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.3.5</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Bristleback.auth.SystemAuthentication.html">Bristleback.auth.SystemAuthentication</a></li>
            
                <li><a href="..&#x2F;classes/Bristleback.Client.html">Bristleback.Client</a></li>
            
                <li><a href="..&#x2F;classes/Bristleback.controller.Action.html">Bristleback.controller.Action</a></li>
            
                <li><a href="..&#x2F;classes/Bristleback.controller.ActionCallback.html">Bristleback.controller.ActionCallback</a></li>
            
                <li><a href="..&#x2F;classes/Bristleback.controller.ActionClass.html">Bristleback.controller.ActionClass</a></li>
            
                <li><a href="..&#x2F;classes/Bristleback.controller.ActionController.html">Bristleback.controller.ActionController</a></li>
            
                <li><a href="..&#x2F;classes/Bristleback.controller.ActionExceptionHandler.html">Bristleback.controller.ActionExceptionHandler</a></li>
            
                <li><a href="..&#x2F;classes/Bristleback.controller.ActionMessage.html">Bristleback.controller.ActionMessage</a></li>
            
                <li><a href="..&#x2F;classes/Bristleback.controller.ClientActionClass.html">Bristleback.controller.ClientActionClass</a></li>
            
                <li><a href="..&#x2F;classes/Bristleback.controller.controllers.html">Bristleback.controller.controllers</a></li>
            
                <li><a href="..&#x2F;classes/Bristleback.LOCAL_HOSTNAME.html">Bristleback.LOCAL_HOSTNAME</a></li>
            
                <li><a href="..&#x2F;classes/Bristleback.template.TemplateController.html">Bristleback.template.TemplateController</a></li>
            
                <li><a href="..&#x2F;classes/Bristleback.USER_CONTEXT.html">Bristleback.USER_CONTEXT</a></li>
            
                <li><a href="..&#x2F;classes/Bristleback.USER_DETAILS.html">Bristleback.USER_DETAILS</a></li>
            
                <li><a href="..&#x2F;classes/Bristleback.utils.html">Bristleback.utils</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/auth.html">auth</a></li>
            
                <li><a href="..&#x2F;modules/Bristleback.html">Bristleback</a></li>
            
                <li><a href="..&#x2F;modules/controller.html">controller</a></li>
            
                <li><a href="..&#x2F;modules/core.html">core</a></li>
            
                <li><a href="..&#x2F;modules/serialization.html">serialization</a></li>
            
                <li><a href="..&#x2F;modules/template.html">template</a></li>
            
                <li><a href="..&#x2F;modules/utils.html">utils</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: bristle-auth.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
 Authentication module

 @module Bristleback
 @submodule auth
 @main Bristleback
 **&#x2F;

&#x2F;**
 * User Details action parameter placeholder
 *
 * @class USER_DETAILS
 * @namespace Bristleback
 * @type String
 * @final
 * @default &quot;ud&quot;
 **&#x2F;
BB.USER_DETAILS = &quot;ud&quot;;

&#x2F;**
 * Creates a new instance of System Authentication controller, which is a part of Action controller.
 * Authentication controller provides methods for logging in and logging out.
 * It also allow user to handle various events and authentication&#x2F;authorization exceptions.
 * This controller provides few built in handlers, all of them can be overridden by application creator.
 * Note that this is a first, beta version of the authentication controller,
 * future version will probably bring more sophisticated and more general solution,
 * that could be used also with Spring Security.
 * @param {Object} dataController data controller.
 * @class SystemAuthentication
 * @namespace Bristleback.auth
 * @constructor
 *&#x2F;
BB.auth.SystemAuthentication = function (dataController) {
  var defaultAuthenticationActionClass = dataController.getActionClass(&quot;BristleSystemUserAuthentication&quot;);
  this.setAsDefaultAuthenticationAction(defaultAuthenticationActionClass.defineAction(&quot;authenticate&quot;));

  var logoutActionClass = dataController.getActionClass(&quot;BristleSystemUserLogout&quot;);
  this.setAsDefaultLogoutAction(logoutActionClass.defineAction(&quot;logout&quot;));

  var authentication = this;
  var systemAuthClientActionClass = {
    authenticationSuccess: function (username) {
      if (authentication.authenticationSuccessCallback) {
        authentication.authenticationSuccessCallback(username);
      } else {
        console.log(&quot;User &#x27;%s&#x27; has been successfully authenticated.&quot;, username);
      }
    },
    logout: function (logoutMessage) {
      if (authentication.logoutCallback) {
        authentication.logoutCallback(logoutMessage);
      } else {
        console.log(&quot;User &#x27;%s&#x27; has been logged out (logout reason: %s).&quot;, logoutMessage.username, logoutMessage.logoutReason);
      }
    }
  };
  dataController.registerClientActionClass(&quot;SystemAuth&quot;, systemAuthClientActionClass);


  dataController.exceptionHandler.setExceptionHandler(&quot;BristleSecurityException&quot;, this.defaultSecurityExceptionHandler);
  dataController.exceptionHandler.setExceptionHandler(&quot;IncorrectUsernameOrPasswordException&quot;, this.defaultIncorrectPasswordHandler);
  dataController.exceptionHandler.setExceptionHandler(&quot;InactiveUserException&quot;, this.defaultSecurityExceptionHandler);
  dataController.exceptionHandler.setExceptionHandler(&quot;UserAlreadyAuthenticatedException&quot;, this.defaultSecurityExceptionHandler);
  dataController.exceptionHandler.setExceptionHandler(&quot;UserNotAuthenticatedException&quot;, this.defaultSecurityExceptionHandler);
  dataController.exceptionHandler.setExceptionHandler(&quot;AuthorizationException&quot;, this.defaultAuthorizationExceptionHandler);
};

&#x2F;**
 * This is a default handler for following exception types:
 * &lt;ul&gt;
 *   &lt;li&gt;BristleSecurityException&lt;&#x2F;li&gt;
 *   &lt;li&gt;InactiveUserException&lt;&#x2F;li&gt;
 *   &lt;li&gt;UserAlreadyAuthenticatedException&lt;&#x2F;li&gt;
 *   &lt;li&gt;UserNotAuthenticatedException&lt;&#x2F;li&gt;
 * &lt;&#x2F;ul&gt;
 * @method defaultSecurityExceptionHandler
 * @param {Object} exception exception containing content and meta information, like exception type or action execution phase.
 *&#x2F;
BB.auth.SystemAuthentication.prototype.defaultSecurityExceptionHandler = function (exception) {
  var usernameMessageSuffix = exception.content.username ? &quot; for user &#x27;&quot; + exception.content.username + &quot;&#x27;.&quot; : &quot;.&quot;;
  var exceptionMessage = &quot;Unexpected &quot; + exception.exceptionType + &quot; security exception occurred&quot; + usernameMessageSuffix;
  throw new Error(exceptionMessage);
};

&#x2F;**
 * This is a default handler for incorrect username or password exception (IncorrectUsernameOrPasswordException).
 * @method defaultIncorrectPasswordHandler
 * @param {Object} exception exception containing content and meta information, like exception type or action execution phase.
 *&#x2F;
BB.auth.SystemAuthentication.prototype.defaultIncorrectPasswordHandler = function (exception) {
  throw new Error(&quot;Incorrect username or password, username provided: &#x27;&quot; + exception.content.username + &quot;&#x27;.&quot;);
};

&#x2F;**
 * This is a default handler for incorrect username or password exception (IncorrectUsernameOrPasswordException).
 * @method defaultIncorrectPasswordHandler
 * @param {Object} exception exception containing content and meta information, like exception type or action execution phase.
 *&#x2F;
BB.auth.SystemAuthentication.prototype.defaultAuthorizationExceptionHandler = function (exception) {
  throw new Error(&quot;User &#x27;&quot; + exception.content.username + &quot;&#x27; tried to invoke action without required authority: &#x27;&quot; + exception.content.authority + &quot;&#x27;.&quot;);
};

&#x2F;**
 * Invokes default authentication action. Arguments of this method passed by user are further transferred to authentication action.
 * System authentication system provides built in default authentication action. To set custom action as the default,
 * use {{#crossLink &quot;Bristleback.auth.SystemAuthentication&#x2F;setAsDefaultAuthenticationAction&quot;}}{{&#x2F;crossLink}} method.
 * @method authenticate
 *&#x2F;
BB.auth.SystemAuthentication.prototype.authenticate = function () {
  this.invokeAction(this.defaultAuthenticationAction, arguments);
};

&#x2F;**
 * Invokes default logout action. Arguments of this method passed by user are further transferred to logout action.
 * System authentication system provides built in default logout action. To set custom action as the default,
 * use {{#crossLink &quot;Bristleback.auth.SystemAuthentication&#x2F;setAsDefaultLogoutAction&quot;}}{{&#x2F;crossLink}} method.
 * @method logout
 *&#x2F;
BB.auth.SystemAuthentication.prototype.logout = function () {
  this.invokeAction(this.defaultLogoutAction, arguments);
};

BB.auth.SystemAuthentication.prototype.invokeAction = function (action, argumentsList) {
  var correctParameters = [];
  var parametersLength = argumentsList.length;
  for (var i = 0; i &lt; parametersLength; i++) {
    correctParameters[i] = argumentsList[i];
  }
  action.actionClass[action.name].apply(action.actionClass, correctParameters);
};

&#x2F;**
 * Sets given action as the default authentication action invoked when calling
 * {{#crossLink &quot;Bristleback.auth.SystemAuthentication&#x2F;authenticate&quot;}}{{&#x2F;crossLink}} method.
 * @method setAsDefaultAuthenticationAction
 * @param {Object} action object created by calling {{#crossLink &quot;Bristleback.controller.ActionClass&#x2F;defineAction&quot;}}{{&#x2F;crossLink}} method.
 *&#x2F;
BB.auth.SystemAuthentication.prototype.setAsDefaultAuthenticationAction = function (action) {
  this.defaultAuthenticationAction = action;
};

&#x2F;**
 * Sets given action as the default authentication action invoked when calling
 * {{#crossLink &quot;Bristleback.auth.SystemAuthentication&#x2F;logout&quot;}}{{&#x2F;crossLink}} method.
 * @method setAsDefaultLogoutAction
 * @param {Object} action object created by calling {{#crossLink &quot;Bristleback.controller.ActionClass&#x2F;defineAction&quot;}}{{&#x2F;crossLink}} method.
 *&#x2F;
BB.auth.SystemAuthentication.prototype.setAsDefaultLogoutAction = function (action) {
  this.defaultLogoutAction = action;
};

&#x2F;**
 * Sets authentication success callback, invoked when system sends a message about successful authentication.
 *
 * @method setAuthenticationSuccessCallback
 * @param {Function} authenticationSuccessCallback function that takes one String parameter: username.
 *&#x2F;
BB.auth.SystemAuthentication.prototype.setAuthenticationSuccessCallback = function (authenticationSuccessCallback) {
  this.authenticationSuccessCallback = authenticationSuccessCallback;
};

&#x2F;**
 * Sets logout callback, invoked when system sends a message about finishing logging out process.
 *
 * @method setLogoutCallback
 * @param {Function} logoutCallback function that takes one Object parameter: logoutMessage,
 * containing fields: username and logoutReason.
 *&#x2F;
BB.auth.SystemAuthentication.prototype.setLogoutCallback = function (logoutCallback) {
  this.logoutCallback = logoutCallback;
};
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
